<ion-header>
  <ion-toolbar class="custom-toolbar">
    <ion-title>Minhas Consultas</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">
  <ion-segment [(ngModel)]="filtroStatus" (ionChange)="filtrarConsultas()">
    <ion-segment-button value="todas"><ion-label>Todas</ion-label></ion-segment-button>
    <ion-segment-button value="agendada"><ion-label>Agendadas</ion-label></ion-segment-button>
    <ion-segment-button value="concluida"><ion-label>Concluídas</ion-label></ion-segment-button>
  </ion-segment>

  @if (consultasFiltradas.length === 0) {
    <div class="sem-consultas">
      <ion-icon name="calendar-outline"></ion-icon>
      <h3>Nenhuma consulta encontrada</h3>
      <p>Você não possui consultas {{ filtroStatus !== 'todas' ? 'com este status' : '' }}</p>
    </div>
  }

  <div class="consultas-grid">
    @for (consulta of consultasFiltradas; track $index) {
    <ion-card class="consulta-card" [ngClass]="'status-' + (consulta.status || 'agendada').toLowerCase()">
      <div class="status-indicator">
        <ion-badge color="light" style="color:#60b12a">{{ getStatusText(consulta.status) }}</ion-badge>
      </div>
      <ion-card-header>
        <ion-card-subtitle>
          <ion-icon name="calendar-outline"></ion-icon>
          {{ consulta.data | date:'dd/MM/yyyy HH:mm' }}
        </ion-card-subtitle>
        <ion-card-title class="pet-nome">{{ consulta.animal.nome }}</ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <div class="info-row"><ion-icon name="person-outline"></ion-icon>{{ consulta.animal.dono.nome }}</div>
        <div class="info-row"><ion-icon name="paw-outline"></ion-icon>{{ consulta.animal.tipo_especie }}</div>
        <div class="info-row"><ion-icon name="medkit-outline"></ion-icon>Dr(a). {{ consulta.veterinario.nome }}</div>
      </ion-card-content>
    </ion-card>
    }
  </div>
</ion-content>
